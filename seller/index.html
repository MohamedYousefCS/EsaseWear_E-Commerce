<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Seller Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    integrity="sha512-7yI2kHsXVT7v1qGQT7cUtU7qQs1+uQWviYnqsFiBeg3ifz4DOGRPUJDX9TxyR+Jcd7P4ptbcejt5nLSx8a9Wog=="
    crossorigin="anonymous" />

  <!-- <link rel="canonical" href="https://getbootstrap.com/docs/5.0/examples/dashboard/"> -->

  <!-- <link rel="stylesheet" href="style.css"> -->

  <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"> -->
  <link href="assets/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    .searchBlock {
      display: flex;
      align-items: center;
    }

    #category {
      padding: 5px;
      cursor: pointer;
      color: white;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
    }

    tr:nth-child(even) {
      background-color: #b097de;
    }

    .modal-content {
      margin: 20px;
      background-color: #fefefe;
      margin: 15% auto;
      padding: 40px;
      border: 1px solid #888;
      width: 700px;
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }

    .close:hover {
      color: black;
    }

    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }
  </style>

  <!-- Custom styles for this template -->
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="dashboard.css">
</head>

<body>
  <header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
    <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3" href="#" id="currentUserName">Company name</a>
    <button class="navbar-toggler position-absolute d-md-none collapsed " type="button" data-bs-toggle="collapse"
      data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <input class="form-control form-control-dark w-100" style="visibility: hidden; height: 0;" type="text"
      placeholder="Search" aria-label="Search">
    <div class="navbar-nav">
      <div class="nav-item text-nowrap">
        <button class="nav-link px-3" id="signOut">Sign out</button>
        <!-- <a  href="#"></a> -->
      </div>
    </div>
  </header>

  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar as Tabs -->
      <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
        <div class="position-sticky pt-3">
          <ul class="nav flex-column nav-pills">
            <li class="nav-item">
              <a class="nav-link active" id="products-tab" data-bs-toggle="pill" data-bs-target="#products" href="#">
                Products
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="orders-tab" data-bs-toggle="pill" data-bs-target="#orders" href="#">
                Orders
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="dashboard-tab" data-bs-toggle="pill" data-bs-target="#dashboard" href="#">
                Charts
              </a>
            </li>
            <li class="nav-item">
              <i class="fas fa-user"></i>
              <a class="nav-link" id="profile-tab" data-bs-toggle="pill" data-bs-target="#customers" href="#">
                profile
              </a>
            </li>
          </ul>
        </div>
      </nav>

      <!-- Main content -->
      <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
        <!-- Content of the tabs -->
        <div class="tab-content">
          <div class="tab-pane fade show active" id="products">
            <!-- Content for Products tab -->
            <div
              class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
              <h1 class="h2">Products</h1>
            </div>

            <!-- ===================start editing================= -->
            <button id="openModalBtn" class="btn-style" style="width: 300px;">add Product</button>
            <br>
            <br>
            <div id="myModal" class="modal">
              <div class="modal-content">
                <h1 style="font-size: 20px;">Add Product Details</h1>
                <!-- ***********class name inpets*********** -->
                <div class="input">
                  <input type="text" id="title" placeholder="title " class="col-8" />
                  <div id="title_val">

                  </div>
                  <input type="number" id="price" placeholder="price" min="1" max="99" class="col-8" />
                  <div id="price_val">

                  </div>
                  <input type="number" id="count" placeholder="count" min="1" class="col-8" />
                  <div id="count_val">

                  </div>
                  <select class="custom-select custom-select-sm btn-style col-8" required id="category">
                    <option value=0 selected>Please choose category</option>
                    <option value="topwear">topwear</option>
                    <option value="jacket">jacket</option>
                    <option value="shoes">shoes</option>
                    <option value="bottomwear">bottomwear</option>
                  </select>
                  <div id="category_val">
                  </div>
                  <input type="file" id="img" class="col-6 btn-style" />
                  <img src="images/logo1.png" id="imgPreview" style="width: 50px ;height: 30px;"
                    alt="placeholder" /><br>
                  <div id="img_val">

                  </div>
                  <button id="submit" class="container btn-style bg-success"
                    style="width: 300px;display: block;margin-top: 20px; text-align: center;">create</button>
                </div>
              </div>
            </div>
            <div class="crud">
              <div class="outputs row">
                <div class="searchBlock col-md-6 col-lg-4">
                  <input onkeyup="searchData(this.value)" type="text" id="search" placeholder="Search"
                    class="form-control mb-2"
                    style="width: 250px;margin-right: 10px;background-color: #F3EDC8;border: 2px;color: black;" />
                  <div class="btnSearch">
                    <button onclick="getSearchMood(this.id)" class="btn-style" id="searchTitle"
                      style="width: 180px;text-align: center;">
                      Search By Title
                    </button>
                    <button onclick="getSearchMood(this.id)" class="btn-style"
                      style="width: 180px; margin-left: 7px;text-align: center;" id="searchCategory">
                      Search By category
                    </button>
                  </div>
                </div>
              </div>
              <table class="table table-bordered container" border="2px" style="border-collapse: collapse;">
                <thead>
                  <tr style="background-color:#b097de;">
                    <th id="test20">id</th>
                    <th>title</th>
                    <th>price</th>
                    <th>count</th>
                    <th>category</th>
                    <th>Img</th>
                    <th>update</th>
                    <th>delete</th>
                  </tr>
                </thead>
                <tbody id="tbody"></tbody>
              </table>
            </div>
          </div>
          <!-- Your existing Products content -->
        </div>
        <div class="tab-pane fade" id="orders">
          <!-- Content for Orders tab -->
          <div
            class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h1 class="h2">Orders</h1>
          </div>
          <table class=" container" border="2px" style="border-collapse: collapse;">
            <thead>
              <tr style="background-color:#b097de;">
                <th>Order id</th>
                <th>Product id</th>
                <th>Price</th>
                <th>Count</th>
                <th>Date Of Order</th>

              </tr>
            </thead>
            <tbody id="orders-tbody">

            </tbody>
          </table>

          <!-- Your existing Orders content -->
        </div>
        <div class="tab-pane fade" id="dashboard">
          <!-- Content for Charts tab -->
          <div
            class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h1 class="h2">Charts</h1>
          </div>
          <div class="container">
            <div class="row align-items-center">
              <div class="containerOne col-12 col-md-6">
                <canvas id="myChartOne"></canvas>
              </div>
              <div class="containerTwo col-12 col-md-6">
                <canvas id="myChartTwo"></canvas>
              </div>
            </div>
          </div>
        </div>
        <div class="tab-pane fade" id="customers">


          <div
            class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h1 class="h2"  style="color: #5f4395;">My Profile</h1><br>

          </div>
          <div>
            <p id="un" class="h3">User Name</p><br>
            <p id="uEmail" class="h2">Email</p>
          </div>
          <!-- Your existing Customers content -->
        </div>
    </div>
    </main>
  </div>
  </div>

  <!-- Your existing script imports -->


  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <script src="main.js"></script>
  <script src="assets/dist/js/bootstrap.bundle.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js"
    integrity="sha384-uO3SXW5IuS1ZpFPKugNNWqTZRRglnUJK6UAZ/gxOX80nxEkN9NcGZTftn6RzhGWE" crossorigin="anonymous">
  </script>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script src="dashboard.js"></script>
  <script>
    //display current user data
    document.getElementById("profile-tab").addEventListener("click", function () {
      document.getElementById("un").innerText += ": " + JSON.parse(localStorage.getItem("user")).name;
      document.getElementById("uEmail").innerText += ": " + JSON.parse(localStorage.getItem("user")).email;
    });
    var myOrderTap = document.getElementById("orders-tab");
    //  myOrderTap.addEventListener("click", function () {
    var currentIndex = JSON.parse(localStorage.getItem("currentindex"));
    var orderData = localStorage.getItem('OrderData');

    var targetSeller = JSON.parse(localStorage.getItem("user")).name; // Replace with the specific seller you want

    // Check if orderData is not null or undefined
    if (orderData) {
      orderData = JSON.parse(orderData); // Parse the JSON if it exists
      console.log(orderData);
      for (let x = 0; x < orderData.length; x++) {

        // Check if orderData[x].quantity is not null or undefined
        if (orderData[x].quantity) {
          orderData[x].quantity.forEach(element => {
            // Check if the quantity array element matches the target seller
            if (element.seller === targetSeller) {
              var calculatedValue = (orderData[x]['Order Id'] * 100);
              var tr = document.createElement("tr");
              var td1 = document.createElement("td");
              var td2 = document.createElement("td");
              var td3 = document.createElement("td");
              var td4 = document.createElement("td");
              var td5 = document.createElement("td");

              td1.innerText = calculatedValue.toFixed();
              td2.innerText = element.productId;
              td3.innerText = element.priceOfItem; // Accessing priceOfItem property
              td4.innerText = element.numOfItems;
              td5.innerText = orderData[x]["Date of Order"];
              tr.appendChild(td1);
              tr.appendChild(td2);
              tr.appendChild(td3);
              tr.appendChild(td4);
              tr.appendChild(td5);
              document.getElementById("orders-tbody").appendChild(tr);
            }
          });
        }
      }
    }
    // });




    window.addEventListener("load", function () {
      document.getElementById("currentUserName").innerText = JSON.parse(localStorage.getItem("user")).name;
      var modal = document.getElementById("myModal");
      var openModalBtn = document.getElementById("openModalBtn");
      var closeModalBtn = document.getElementById("submit");

      function openModal() {
        modal.style.display = "block";
      }

      function closeModal() {
        modal.style.display = "none";
      }

      openModalBtn.addEventListener("click", openModal);
      //closeModalBtn.addEventListener("click", closeModal);
      var I = 0;
      // Close the modal if the user clicks outside the modal content
      window.addEventListener("click", function (event) {
        if (event.target == modal) {
          closeModal();
        }
      });

      // Add event listener for tab changes
      var tabs = document.querySelectorAll('.nav-link');
      tabs.forEach(function (tab, index) {
        tab.addEventListener('click', function (event) {
          // Hide all tab content
          document.querySelectorAll('.tab-pane').forEach(function (content) {
            content.style.display = 'none';
          });
          I = index;
          // Show the selected tab content
          var targetId = event.target.getAttribute('data-bs-target').substring(1);
          document.getElementById(targetId).style.display = 'block';
          //to be able to access tab index from external json
          window.currentTabIndex = index;
          localStorage.setItem("currentindex", JSON.stringify(index));


        });





      });

    });
  </script>
</body>

</html>